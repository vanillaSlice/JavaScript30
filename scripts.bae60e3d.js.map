{"version":3,"sources":["19 - Webcam Fun/scripts/index.js"],"names":["filterElement","document","querySelector","takePhotoBtn","photoElement","playerElement","context","getContext","stripElement","snapElement","selectedFilter","rgbSplit","pixels","i","data","length","redEffect","loveless","globalAlpha","applyFilter","paintToCanvas","width","videoWidth","height","videoHeight","setInterval","drawImage","getImageData","putImageData","getVideo","navigator","mediaDevices","getUserMedia","video","audio","then","localMediaStream","srcObject","onloadedmetadata","play","catch","err","console","error","takePhoto","currentTime","toDataURL","link","createElement","classList","href","setAttribute","innerHTML","insertBefore","firstChild","addEventListener","e","target","value"],"mappings":";AAUA,IAAMA,EAAgBC,SAASC,cAAc,cACvCC,EAAeF,SAASC,cAAc,kBACtCE,EAAeH,SAASC,cAAc,aACtCG,EAAgBJ,SAASC,cAAc,cACvCI,EAAUF,EAAaG,WAAW,MAClCC,EAAeP,SAASC,cAAc,aACtCO,EAAcR,SAASC,cAAc,YAMvCQ,EAAiB,OAMrB,SAASC,EAASC,GACX,IAAA,IAAIC,EAAI,EAAGA,EAAID,EAAOE,KAAKC,OAAQF,GAAK,EAC3CD,EAAOE,KAAKD,EAAI,KAAOD,EAAOE,KAAKD,GACnCD,EAAOE,KAAKD,EAAI,KAAOD,EAAOE,KAAKD,EAAI,GACvCD,EAAOE,KAAKD,EAAI,KAAOD,EAAOE,KAAKD,EAAI,GAI3C,SAASG,EAAUJ,GACZ,IAAA,IAAIC,EAAI,EAAGA,EAAID,EAAOE,KAAKC,OAAQF,GAAK,EAC3CD,EAAOE,KAAKD,IAAM,IAClBD,EAAOE,KAAKD,EAAI,IAAM,GACtBD,EAAOE,KAAKD,EAAI,IAAM,GAI1B,SAASI,EAASL,GAChBN,EAAQY,YAAc,IACjB,IAAA,IAAIL,EAAI,EAAGA,EAAID,EAAOE,KAAKC,OAAQF,GAAK,EAC3CD,EAAOE,KAAKD,IAAM,GAClBD,EAAOE,KAAKD,EAAI,IAAM,EACtBD,EAAOE,KAAKD,EAAI,IAAM,EAI1B,SAASM,EAAYP,GAEXF,OADRJ,EAAQY,YAAc,EACdR,GACD,IAAA,YACHC,EAASC,GACT,MACG,IAAA,aACHI,EAAUJ,GACV,MACG,IAAA,WACHK,EAASL,IAOf,SAASQ,IACDC,IAAAA,EAAQhB,EAAciB,WACtBC,EAASlB,EAAcmB,YAGtBC,OAFPrB,EAAaiB,MAAQA,EACrBjB,EAAamB,OAASA,EACfE,YAAY,WACjBnB,EAAQoB,UAAUrB,EAAe,EAAG,EAAGgB,EAAOE,GACxCX,IAAAA,EAASN,EAAQqB,aAAa,EAAG,EAAGN,EAAOE,GACjDJ,EAAYP,GACZN,EAAQsB,aAAahB,EAAQ,EAAG,IAC/B,IAGL,SAASiB,IACPC,UAAUC,aAAaC,aAAa,CAClCC,OAAO,EACPC,OAAO,IAENC,KAAK,SAACC,GACL/B,EAAcgC,UAAYD,EAC1B/B,EAAciC,iBAAmB,WAC/BjC,EAAckC,UAGjBC,MAAM,SAACC,GACNC,QAAQC,MAAM,YAAaF,KAIjC,SAASG,IAEPnC,EAAYoC,YAAc,EAC1BpC,EAAY8B,OAGNzB,IAAAA,EAAOV,EAAa0C,UAAU,cAC9BC,EAAO9C,SAAS+C,cAAc,KACpCD,EAAKE,WAAa,cAClBF,EAAKG,KAAOpC,EACZiC,EAAKI,aAAa,WAAY,YAC9BJ,EAAKK,UAA2CtC,+BAAAA,OAAAA,EAAhD,wBACAN,EAAa6C,aAAaN,EAAMvC,EAAa8C,YAO/CjD,EAAckD,iBAAiB,UAAWnC,GAC1CpB,EAAcuD,iBAAiB,SAAU,SAACC,GACxC9C,EAAiB8C,EAAEC,OAAOC,QAE5BvD,EAAaoD,iBAAiB,QAASX,GACvCf","file":"scripts.bae60e3d.js","sourceRoot":"../src","sourcesContent":["/*\n  eslint-disable\n    no-param-reassign,\n    no-console,\n*/\n\n/*\n * Elements\n */\n\nconst filterElement = document.querySelector('.js-filter');\nconst takePhotoBtn = document.querySelector('.js-take-photo');\nconst photoElement = document.querySelector('.js-photo');\nconst playerElement = document.querySelector('.js-player');\nconst context = photoElement.getContext('2d');\nconst stripElement = document.querySelector('.js-strip');\nconst snapElement = document.querySelector('.js-snap');\n\n/**\n * Variables\n */\n\nlet selectedFilter = 'none';\n\n/*\n * Functions\n */\n\nfunction rgbSplit(pixels) {\n  for (let i = 0; i < pixels.data.length; i += 4) {\n    pixels.data[i - 350] = pixels.data[i];\n    pixels.data[i + 100] = pixels.data[i + 1];\n    pixels.data[i - 250] = pixels.data[i + 2];\n  }\n}\n\nfunction redEffect(pixels) {\n  for (let i = 0; i < pixels.data.length; i += 4) {\n    pixels.data[i] += 100;\n    pixels.data[i + 1] -= 50;\n    pixels.data[i + 2] *= 0.5;\n  }\n}\n\nfunction loveless(pixels) {\n  context.globalAlpha = 0.02;\n  for (let i = 0; i < pixels.data.length; i += 4) {\n    pixels.data[i] += 10;\n    pixels.data[i + 1] += 2;\n    pixels.data[i + 2] += 5;\n  }\n}\n\nfunction applyFilter(pixels) {\n  context.globalAlpha = 1;\n  switch (selectedFilter) {\n    case 'rgb-split':\n      rgbSplit(pixels);\n      break;\n    case 'red-effect':\n      redEffect(pixels);\n      break;\n    case 'loveless':\n      loveless(pixels);\n      break;\n    default:\n      break;\n  }\n}\n\nfunction paintToCanvas() {\n  const width = playerElement.videoWidth;\n  const height = playerElement.videoHeight;\n  photoElement.width = width;\n  photoElement.height = height;\n  return setInterval(() => {\n    context.drawImage(playerElement, 0, 0, width, height);\n    const pixels = context.getImageData(0, 0, width, height);\n    applyFilter(pixels);\n    context.putImageData(pixels, 0, 0);\n  }, 16);\n}\n\nfunction getVideo() {\n  navigator.mediaDevices.getUserMedia({\n    video: true,\n    audio: false,\n  })\n    .then((localMediaStream) => {\n      playerElement.srcObject = localMediaStream;\n      playerElement.onloadedmetadata = () => {\n        playerElement.play();\n      };\n    })\n    .catch((err) => {\n      console.error('OH NOOOOO', err);\n    });\n}\n\nfunction takePhoto() {\n  // play the sound\n  snapElement.currentTime = 0;\n  snapElement.play();\n\n  // create photo and add download link\n  const data = photoElement.toDataURL('image/jpeg');\n  const link = document.createElement('a');\n  link.classList += 'strip__link';\n  link.href = data;\n  link.setAttribute('download', 'handsome');\n  link.innerHTML = `<img class=\"strip__img\" src=${data} alt=\"Handsome Man\">`;\n  stripElement.insertBefore(link, stripElement.firstChild);\n}\n\n/*\n * Initialise\n */\n\nplayerElement.addEventListener('canplay', paintToCanvas);\nfilterElement.addEventListener('change', (e) => {\n  selectedFilter = e.target.value;\n});\ntakePhotoBtn.addEventListener('click', takePhoto);\ngetVideo();\n"]}